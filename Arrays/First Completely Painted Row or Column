class Pair{
    int row;
    int col;

    public Pair(int row, int col){
        this.row=row;
        this.col=col;
    }
}


class Solution {
    public int firstCompleteIndex(int[] arr, int[][] mat) {
        int rowSize=mat.length;
        int colSize=mat[0].length;

        int n=arr.length;
        Map<Integer,Pair> map=new HashMap<>();
        Map<Integer,Integer> rowMap=new HashMap<>();
        Map<Integer,Integer> colMap=new HashMap<>();

        for(int i=0;i<rowSize;i++){
            for(int j=0;j<colSize;j++){
                map.put(mat[i][j],new Pair(i,j));
            }
        }


        for(int i=0;i<n;i++){
            int value=arr[i];
            int row=map.get(value).row;
            int col=map.get(value).col;

            rowMap.put(row,rowMap.getOrDefault(row,0)+1);
            colMap.put(col,colMap.getOrDefault(col,0)+1);

// Remember row paint size mean colSize and vice versa
            if(rowMap.get(row)==colSize) return i;

            if(colMap.get(col)==rowSize) return i;

        }

        return -1;
    }
}
